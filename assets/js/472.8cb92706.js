(window.webpackJsonp=window.webpackJsonp||[]).push([[472],{905:function(t,a,s){"use strict";s.r(a);var n=s(2),e=Object(n.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"dva-åŸºæœ¬ç”¨æ³•"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dva-åŸºæœ¬ç”¨æ³•"}},[t._v("#")]),t._v(" dva åŸºæœ¬ç”¨æ³•")]),t._v(" "),a("blockquote",[a("p",[t._v("example")])]),t._v(" "),a("div",{staticClass:"language-ts extra-class"},[a("pre",{pre:!0,attrs:{class:"language-ts"}},[a("code",[t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" EActiveKey "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'../common'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" apiCategoryPortrait"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" localCategoryPortrait "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'../services'")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" getHeaderMsgFromData"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" getRankingDataByTab"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" getRankingFromData "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./tools'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  namespace"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'catePort'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  state"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    loading"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    activeKey"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" EActiveKey"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Shop"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    headerMsg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      comp"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        title"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ç«å¯¹æ•°æ®'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        first_online_time"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        shop_num"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12345")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        shop_have_sales_num"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12345")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        item_online_num"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12345")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        item_have_sales_num"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12345")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      dy"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        title"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ç«™å†…æ•°æ®'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        first_online_time"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        shop_num"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12345")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        shop_have_sales_num"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12345")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        item_online_num"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12345")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        item_have_sales_num"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12345")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    rankingData"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      shop"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        compTitle"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ç«å¯¹å•†å®¶TOP 50'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        comp"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        dyTitle"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ç«™å†…å•†å®¶TOP 50'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        dy"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      goods"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        compTitle"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ç«å¯¹å•†å“TOP 50'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        comp"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        dyTitle"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ç«™å†…å•†å“TOP 50'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        dy"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    currentRanking"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      compTitle"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ç«å¯¹å•†å®¶TOP 50'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      comp"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      dyTitle"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ç«™å†…å•†å®¶TOP 50'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      dy"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n  reducers"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateActivityKey")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" payload "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        activeKey"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" payload"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolved")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" payload "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" payload "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("payload\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeaderMsg")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" payload "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("payload"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setRankingData")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" payload "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("payload"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateRanking")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" payload "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" activeKey "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" payload"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        currentRanking"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getRankingDataByTab")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("activeKey"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rankingData"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        activeKey"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n  effects"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("requestCategory")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("action"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" params"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("any")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" put"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" select "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("any")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("yield")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        type"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'setData'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        payload"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          loading"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          competitionData"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          dyData"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          headerMsg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          rankingData"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// const { data } = yield Service.categoryMsg({...action.params});")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// const { data } = yield Service.apiCategoryMsg({...action.params});")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" data "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("yield")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("localCategoryPortrait")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("action"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("params"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" competition_data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" dy_data "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// console.log('getHeaderMsgFromData', getHeaderMsgFromData(competition_data, dy_data));")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// console.log('getRankingFromData', getRankingFromData(competition_data, dy_data));")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("yield")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        type"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'resolved'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        payload"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          loading"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("yield")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        type"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'setHeaderMsg'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        payload"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          headerMsg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getHeaderMsgFromData")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("competition_data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" dy_data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("yield")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        type"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'setRankingData'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        payload"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          rankingData"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getRankingFromData")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("competition_data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" dy_data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" currentRanking "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("select")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("any")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("catePort"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("currentRanking"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("yield")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        type"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'updateRanking'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        payload"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          currentRanking"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * ä¿å­˜ catePort é™æ€å­—ç¬¦ä¸²çš„å¯¹è±¡\n */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ICatePortAction")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  spaceName"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  effects"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    requestCategory"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  reducers"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    updateActivityKey"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    setData"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    setHeaderMsg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    setRankingData"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    updateRanking"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" catePort"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" ICatePortAction "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  spaceName"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'catePort'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  effects"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    requestCategory"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'catePort/requestCategory'")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  reducers"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    updateActivityKey"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'catePort/updateActivityKey'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    setData"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'catePort/setData'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    setHeaderMsg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'catePort/setHeaderMsg'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    setRankingData"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'catePort/setRankingData'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    updateRanking"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'catePort/updateRanking'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("h2",{attrs:{id:"dvajs-å­¦ä¹ ç¬”è®°-effects-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dvajs-å­¦ä¹ ç¬”è®°-effects-api"}},[t._v("#")]),t._v(" dvajs å­¦ä¹ ç¬”è®°- effects API")]),t._v(" "),a("blockquote",[a("p",[t._v("æœ€è¿‘åœ¨å­¦ä¹  dva, ä½†å‘ç°å®˜æ–¹æ–‡æ¡£æœ‰ç‚¹æ»åï¼Œæ‰€ä»¥è‡ªå·±è®°å½•ä¸‹ç¬”è®°ï¼Œå¦‚æœ‰ç¬”è¯¯æˆ–è€…ç†è§£ä¸å½“çš„åœ°æ–¹ï¼Œè¿˜è¯·æŒ‡æ­£ ğŸ˜Š")])]),t._v(" "),a("p",[t._v("dva æ˜¯ä¸€ä¸ªåŸºäº redux å’Œ redux-saga çš„æ•°æ®æµæ–¹æ¡ˆï¼Œå…¶ä¸­ effects æ˜¯ Action å¤„ç†å™¨ï¼Œå¤„ç†å¼‚æ­¥åŠ¨ä½œï¼ŒåŸºäº Redux-saga å®ç°ã€‚Effect æŒ‡çš„æ˜¯å‰¯ä½œç”¨ã€‚æ ¹æ®å‡½æ•°å¼ç¼–ç¨‹ï¼Œè®¡ç®—ä»¥å¤–çš„æ“ä½œéƒ½å±äº Effectï¼Œå…¸å‹çš„å°±æ˜¯ I/O æ“ä½œã€æ•°æ®åº“è¯»å†™")]),t._v(" "),a("p",[a("strong",[t._v("åœ¨æœ¬ model ä¸­è°ƒç”¨ action æ˜¯ä¸ç”¨åŠ  namespaceï¼Œå¦‚æœåŠ ä¸Šç”šè‡³ä¼šæŠ›å‡ºè­¦å‘Šï¼Œè·¨ model è°ƒç”¨æ‰è¦åŠ ä¸Š namespace åŒºåˆ†")])]),t._v(" "),a("ul",[a("li",[t._v("call "),a("code",[t._v("é˜»å¡")]),t._v(" ç”¨äºè°ƒç”¨å¼‚æ­¥é€»è¾‘ï¼Œæ”¯æŒ promise")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("  const result = yield call(fetch, payload);\n\n")])])]),a("ul",[a("li",[t._v("put "),a("code",[t._v("ä¸é˜»å¡")]),t._v(" ç”¨äºè§¦å‘ action, ä¸€èˆ¬æ¥è§¦å‘ reducer æ”¹å˜ state")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("  yield put({ type: 'todos/add', payload: 'Learn Dva' });\n\n")])])]),a("ul",[a("li",[a("p",[t._v("put.resolve "),a("code",[t._v("é˜»å¡")]),t._v(" åŠŸèƒ½ä¸ put ä¸€æ ·ï¼ŒåŒºåˆ«æ˜¯ put.resolve æ˜¯é˜»å¡çš„ï¼Œæ‰§è¡Œå®Œæ‰è¿›è¡Œä¸‹ä¸€æ­¥")])]),t._v(" "),a("li",[a("p",[t._v("select "),a("code",[t._v("ä¸é˜»å¡")]),t._v(" ç”¨äºä» state é‡Œè·å–æ•°æ®")])])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("  const { args } = yield select(state => state[namespace]);\n\n")])])]),a("ul",[a("li",[t._v("take "),a("code",[t._v("é˜»å¡")]),t._v(" dva å°è£…äº† takeï¼Œå¯ä»¥ç›‘å¬ action çš„å¼€å§‹å’Œç»“æŸé˜¶æ®µï¼Œtake ä¼šé˜»å¡åˆ°ç›‘å¬çš„äº‹ä»¶è§¦å‘ï¼Œæ‰æ‰§è¡Œä¸‹ä¸€æ­¥")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("  it('take', done => {\n  const app = create();\n  app.model({\n    namespace: 'count',\n    state: 0,\n    reducers: {\n      add(state, { payload }) {\n        return state + payload || 1;\n      },\n    },\n    effects: {\n      *addDelay({ payload }, { put, call }) {\n        yield call(delay, payload.delay || 100);\n        yield put({ type: 'add', payload: payload.amount });\n      },\n      *test(action, { put, select, take }) {\n        yield put({ type: 'addDelay', payload: { amount: 2 } });\n        // @@start æ˜¯ç›‘å¬putæ“ä½œçš„ç¬¬ä¸€æ­¥ï¼Œå³payloadä¸stateè¿˜æ²¡åˆå¹¶ï¼Œè¿™æ—¶stateä¸º0\n        //yield take('addDelay/@@start');\n        //@@end æ˜¯ç›‘å¬putæ“ä½œçš„æœ€åä¸€æ­¥ï¼Œå³å°†payloadä¸stateåˆå¹¶ï¼Œè¿”å›æ–°çš„stateï¼Œè¿™æ—¶stateä¸º2\n        yield take('addDelay/@@end');\n        const count = yield select(state => state.count);\n        yield put({ type: 'addDelay', payload: { amount: count, delay: 0 } });\n      },\n    },\n  });\n  app.start();\n  app._store.dispatch({ type: 'count/test' });\n  setTimeout(() => {\n    expect(app._store.getState().count).toEqual(4);\n    done();\n  }, 300);\n  });\n\n")])])]),a("p",[t._v("å¯ä»¥ç›‘å¬ action æ•°ç»„ï¼Œæ»¡è¶³ä¸€ä¸ªå³å¯")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("  it('take with array of actions', () => {\n  const app = create();\n  let takenCount = 0;\n  app.model({\n    namespace: 'count',\n    state: null,\n    reducers: {\n      addRequest() {\n        return 1;\n      },\n      addFailure() {\n        return -1;\n      },\n      addSuccess() {\n        return 0;\n      },\n    },\n    effects: {\n      *add(action, { put }) {\n        yield put({ type: 'addRequest' });\n        if (action.amount > 0.5) {\n          yield put({ type: 'addSuccess' });\n        } else {\n          yield put({ type: 'addFailure' });\n        }\n      },\n      *test(action, { put, take }) {\n        yield put({ type: 'add', amount: action.amount });\n        yield take(['addSuccess', 'addFailure']);\n        takenCount += 1;\n      },\n    },\n  });\n  app.start();\n  app._store.dispatch({ type: 'count/test', amount: 0 });\n  expect(app._store.getState().count).toEqual(-1);\n  app._store.dispatch({ type: 'count/test', amount: 1 });\n  expect(app._store.getState().count).toEqual(0);\n  expect(takenCount).toEqual(2);\n  });\n\n")])])]),a("p",[t._v("å¯ä»¥ç›‘å¬å…¶ä»– model çš„ actionï¼Œå¿…é¡»è¦åŠ å¯¹åº”çš„ namespace")]),t._v(" "),a("ul",[a("li",[t._v("takeLatest "),a("code",[t._v("ä¸é˜»å¡")]),t._v(" ä½¿ç”¨ takeLatest æ¥å¯åŠ¨ä¸€ä¸ªæ–°çš„ actionã€‚ ç”±äº takeLatest å–æ¶ˆäº†æ‰€æœ‰ä¹‹å‰å¯åŠ¨ä¸”æœªå®Œæˆçš„ä»»åŠ¡ï¼Œå³ä½¿ç”¨æˆ·ä»¥æå¿«çš„é€Ÿåº¦è¿ç»­å¤šæ¬¡è§¦å‘ actionï¼Œæˆ‘ä»¬éƒ½åªä¼šä»¥æœ€åçš„ä¸€ä¸ªç»“æŸã€‚")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("  it('type: takeLatest', done => {\n  const app = create();\n  app.model({\n    namespace: 'count',\n    state: 0,\n    reducers: {\n      add(state, { payload }) {\n        return state + payload || 1;\n      },\n    },\n    effects: {\n      addDelay: [\n        function*({ payload }, { call, put }) {\n          yield call(delay, 100);\n          yield put({ type: 'add', payload });\n        },\n        { type: 'takeLatest' }\n      ],\n    },\n  });\n  app.start();\n\n  // Only catch the last one.\n  app._store.dispatch({ type: 'count/addDelay', payload: 2 });\n  app._store.dispatch({ type: 'count/addDelay', payload: 3 });\n\n  setTimeout(() => {\n    expect(app._store.getState().count).toEqual(3);\n    done();\n  }, 200);\n  });\n\n")])])]),a("ul",[a("li",[t._v("throttle "),a("code",[t._v("ä¸é˜»å¡")]),t._v(" å®ƒåœ¨æ´¾ç”Ÿä¸€æ¬¡ä»»åŠ¡ä¹‹åï¼Œä»ç„¶å°†æ–°ä¼ å…¥çš„ action æ¥æ”¶åˆ°åº•å±‚çš„ buffer ä¸­ï¼Œè‡³å¤šä¿ç•™ï¼ˆæœ€è¿‘çš„ï¼‰ä¸€ä¸ªã€‚ä½†ä¸æ­¤åŒæ—¶ï¼Œå®ƒåœ¨ ms æ¯«ç§’å†…å°†æš‚åœæ´¾ç”Ÿæ–°çš„ä»»åŠ¡ â€”â€” è¿™ä¹Ÿå°±æ˜¯å®ƒè¢«å‘½åä¸ºèŠ‚æµé˜€ï¼ˆthrottleï¼‰çš„åŸå› ã€‚å…¶ç”¨é€”ï¼Œæ˜¯åœ¨å¤„ç†ä»»åŠ¡æ—¶ï¼Œæ— è§†ç»™å®šçš„æ—¶é•¿å†…æ–°ä¼ å…¥çš„ actionã€‚")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("  it('type: throttle', done => {\n  const app = create();\n  app.model({\n   namespace: 'count',\n   state: 0,\n   reducers: {\n     add(state, { payload }) {\n       return state + payload || 1;\n     },\n   },\n   effects: {\n     addDelay: [\n       function*({ payload }, { call, put }) {\n         yield call(delay, 100);\n         yield put({ type: 'add', payload });\n       },\n       { type: 'throttle', ms: 100 }, // mså¿…é¡»å­˜åœ¨\n     ],\n   },\n  });\n  app.start();\n\n  // Only catch the last one.\n  app._store.dispatch({ type: 'count/addDelay', payload: 2 });\n  app._store.dispatch({ type: 'count/addDelay', payload: 3 });\n\n  setTimeout(() => {\n   expect(app._store.getState().count).toEqual(2);\n   done();\n  }, 200);\n  });\n\n")])])]),a("ul",[a("li",[t._v("watcher ç›‘å¬äº‹ä»¶ï¼Œä¸è¿‡åªèƒ½æ‰§è¡Œä¸€æ¬¡")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("   it('type: watcher', done => {\n  const watcher = { type: 'watcher' };\n  const app = create();\n  app.model({\n    namespace: 'count',\n    state: 0,\n    reducers: {\n      add(state, { payload }) {\n        return state + payload || 1;\n      },\n    },\n    effects: {\n      addWatcher: [\n        function*({ take, put, call }) {\n          while (true) {\n            const { payload } = yield take('addWatcher');\n            yield call(delay, 100);\n            yield put({ type: 'add', payload });\n          }\n        },\n        watcher,\n      ],\n    },\n  });\n  app.start();\n\n  // Only catch the first one.\n  app._store.dispatch({ type: 'count/addWatcher', payload: 2 });\n  app._store.dispatch({ type: 'count/addWatcher', payload: 3 });\n\n  setTimeout(() => {\n    expect(app._store.getState().count).toEqual(2);\n    done();\n  }, 200);\n  });\n\n")])])]),a("ul",[a("li",[t._v("poll"),a("br"),t._v("\nè½®è¯¢")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("   it('type: poll', done => {\n  const app = create();\n  app.model({\n    namespace: 'count',\n    state: 0,\n    reducers: {\n      add(state, { payload }) {\n        return state + payload || 1;\n      },\n    },\n    effects: {\n      pollAdd: [\n        function*(_, { put }) {\n          yield put({ type: 'add', payload: 1 });\n        },\n        { type: 'poll', delay: 1000 },\n      ],\n    },\n  });\n  app.start();\n\n  app._store.dispatch({ type: 'count/pollAdd-start' });\n\n  setTimeout(() => {\n    app._store.dispatch({ type: 'count/pollAdd-stop' });\n    expect(app._store.getState().count).toEqual(2);\n    done();\n  }, 2000);\n  });\n\n")])])]),a("p",[t._v("ä»¥ä¸Šé¢ä¾‹å­æ¥è¯´=> { type: 'poll', delay: 1000 }æ¥è¡¨ç¤ºæ˜¯è½®è¯¢ï¼Œdelay è¡¨ç¤ºé—´éš”å¤šå°‘ç§’è½®è¯¢ä¸€æ¬¡ã€‚ "),a("code",[t._v("dispatch({ type: 'count/pollAdd-start' })")]),t._v(" è¡¨ç¤ºè½®è¯¢å¼€å§‹ï¼Œ "),a("code",[t._v("dispatch({ type: 'count/pollAdd-stop' })")]),t._v(" è¡¨ç¤ºè½®è¯¢ç»“æŸï¼Œä½†ä¸ä¼šä¸­æ–­æœ€åä¸€æ¬¡çš„è¯·æ±‚ã€‚")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("  app._store.dispatch({ type: 'count/pollAdd-start' });\n  // å³ä½¿ç´§æ¥ç€å–æ¶ˆè½®è¯¢ï¼Œä½†è¿˜æ˜¯ä¼šæ‰§è¡Œä¸€æ¬¡\n  app._store.dispatch({ type: 'count/pollAdd-stop' });\n\n")])])]),a("p",[a("code",[t._v("dispatch({ type: 'count/pollAdd-start' }, payload: 2)")]),t._v(" å¯ä»¥æºå¸¦å‚æ•°ï¼Œå³ä»è½®è¯¢å¼€å§‹åˆ°ç»“æŸæ¯æ¬¡è½®è¯¢éƒ½ä¼šä¼ è¿›å»")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("  ...\n  effects: {\n      pollAdd: [\n        function*({ payload }, { put }) {\n          yield put({ type: 'add', payload });\n        },\n        { type: 'poll', delay: 1000 },\n      ],\n    },\n  ...\n  app._store.dispatch({ type: 'count/pollAdd-start', payload: 2 });\n\n  setTimeout(() => {\n    app._store.dispatch({ type: 'count/pollAdd-stop' });\n    expect(app._store.getState().count).toEqual(4);\n    done();\n  }, 2000);\n\n")])])]),a("p",[t._v("è½®è¯¢å¼€å§‹ "),a("code",[t._v("dispatch({ type: 'count/pollAdd-start' })")]),t._v(" åï¼Œåªèƒ½ "),a("code",[t._v("dispatch({ type: 'count/pollAdd-stop' })")]),t._v(" ç»“æŸè½®è¯¢ï¼Œæ‰èƒ½å¼€å§‹æ–°çš„ä¸€è½®è½®è¯¢ã€‚é‡å¤å¼€å§‹æˆ–è€…ç»“æŸæ‰§è¡Œæ— æ•ˆã€‚")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("  ...\n  state: 0,\n    reducers: {\n      add(state, { payload }) {\n        return state + payload || 1;\n      },\n    },\n   effects: {\n      pollAdd: [\n        function*({ payload }, { put }) {\n          yield put({ type: 'add', payload });\n        },\n        { type: 'poll', delay: 1000 },\n      ],\n    }\n    ...\n  //1.\n  app._store.dispatch({ type: 'count/pollAdd-start', payload: 2 });\n\n  setTimeout(() => {\n    // second start should not work\n    app._store.dispatch({ type: 'count/pollAdd-start', payload: 3 });\n    app._store.dispatch({ type: 'count/pollAdd-stop' });\n    expect(app._store.getState().count).toEqual(6);\n    done();\n  }, 3000);\n  //2.\n  app._store.dispatch({ type: 'count/pollAdd-start', payload: 1 });\n  // second start should not work\n  app._store.dispatch({ type: 'count/pollAdd-start', payload: 1 });\n\n  setTimeout(() => {\n    app._store.dispatch({ type: 'count/pollAdd-stop' });\n    expect(app._store.getState().count).toEqual(3);\n    done();\n  }, 3000);\n  //3.\n  app._store.dispatch({ type: 'count/pollAdd-start', payload: 1 });\n  app._store.dispatch({ type: 'count/pollAdd-stop' });\n  app._store.dispatch({ type: 'count/pollAdd-start', payload: 1 });\n\n  setTimeout(() => {\n    app._store.dispatch({ type: 'count/pollAdd-stop' });\n    expect(app._store.getState().count).toEqual(3);\n    done();\n  }, 2000);\n  });\n\n")])])]),a("p",[t._v("poll æºç ï¼š")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("  case 'poll':\n    return function*() {\n      function delay(timeout) {\n        return new Promise(resolve => setTimeout(resolve, timeout));\n      }\n      function* pollSagaWorker(sagaEffects, action) {\n        const { call } = sagaEffects;\n        while (true) {\n          yield call(sagaWithOnEffect, action);\n          yield call(delay, delayMs);\n        }\n      }\n      const { call, take, race } = sagaEffects;\n      while (true) {\n        const action = yield take(`${key}-start`);\n        yield race([call(pollSagaWorker, sagaEffects, action), take(`${key}-stop`)]);\n      }\n    };\n\n")])])]),a("h3",{attrs:{id:"å‚è€ƒèµ„æ–™"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å‚è€ƒèµ„æ–™"}},[t._v("#")]),t._v(" å‚è€ƒèµ„æ–™")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fdvajs%2Fdva%2Fblob%2Fmaster%2Fpackages%2Fdva-core%2Ftest%2Feffects.test.js",title:"https://github.com/dvajs/dva/blob/master/packages/dva-core/test/effects.test.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("github.com/dvajs/dva/bâ€¦"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://link.juejin.cn?target=https%3A%2F%2Fdvajs.com%2Fguide%2F",title:"https://dvajs.com/guide/",target:"_blank",rel:"noopener noreferrer"}},[t._v("dva å®˜ç½‘"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fdvajs%2Fdva%2Fblob%2Fmaster%2FREADME_zh-CN.md",title:"https://github.com/dvajs/dva/blob/master/README_zh-CN.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("dva-github"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=e.exports}}]);
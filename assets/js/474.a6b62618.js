(window.webpackJsonp=window.webpackJsonp||[]).push([[474],{906:function(e,t,r){"use strict";r.r(t);var a=r(2),n=Object(a.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("p",[e._v("距离 "),t("a",{attrs:{href:"https://github.com/sorrycc/blog/issues/64",target:"_blank",rel:"noopener noreferrer"}},[e._v("umi 1.0 发布"),t("OutboundLink")],1),e._v(" 已有半年，umi 在这段时间做了大量的重构和改进，438 个 commit，20 个 beta 版本，"),t("strong",[e._v("今天正式发布 2.0 版本，并调整定位为可插拔的企业级 react 应用框架")]),e._v("。")]),e._v(" "),t("h2",{attrs:{id:"umi-是什么"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#umi-是什么"}},[e._v("#")]),e._v(" umi 是什么？")]),e._v(" "),t("p",[e._v("umi，中文可发音为乌米，是一个可插拔的企业级 react 应用框架。umi 以路由为基础的，支持"),t("a",{attrs:{href:"https://umijs.org/zh/guide/router.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("类 next.js 的约定式路由"),t("OutboundLink")],1),e._v("，以及各种进阶的路由功能，并以此进行功能扩展，比如"),t("a",{attrs:{href:"https://umijs.org/zh/plugin/umi-plugin-react.html#dynamicimport",target:"_blank",rel:"noopener noreferrer"}},[e._v("支持路由级的按需加载"),t("OutboundLink")],1),e._v("。然后配以完善的"),t("a",{attrs:{href:"https://umijs.org/zh/plugin/",target:"_blank",rel:"noopener noreferrer"}},[e._v("插件体系"),t("OutboundLink")],1),e._v("，覆盖从源码到构建产物的每个生命周期，支持各种功能扩展和业务需求，目前内外部加起来已有 50+ 的插件。")]),e._v(" "),t("p",[e._v("umi 是蚂蚁金服的底层前端框架，已直接或间接地服务了 600+ 应用，包括 java、node、H5 无线、离线（Hybrid）应用、纯前端 assets 应用、CMS 应用等。他已经很好地服务了我们的内部用户，同时希望他也能服务好外部用户。")]),e._v(" "),t("p",[e._v("他包含以下特性：")]),e._v(" "),t("ul",[t("li",[e._v("📦 "),t("strong",[e._v("开箱即用")]),e._v("，内置 react、react-router 等")]),e._v(" "),t("li",[e._v("🏈 "),t("strong",[e._v("类 next.js 且"),t("a",{attrs:{href:"https://umijs.org/zh/guide/router.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("功能完备"),t("OutboundLink")],1),e._v("的路由约定")]),e._v("，同时支持配置的路由方式")]),e._v(" "),t("li",[e._v("🎉 "),t("strong",[e._v("完善的插件体系")]),e._v("，覆盖从源码到构建产物的每个生命周期")]),e._v(" "),t("li",[e._v("🚀 "),t("strong",[e._v("高性能")]),e._v("，通过插件支持 PWA、以路由为单元的 code splitting 等")]),e._v(" "),t("li",[e._v("💈 "),t("strong",[e._v("支持静态页面导出")]),e._v("，适配各种环境，比如中台业务、无线业务、"),t("a",{attrs:{href:"https://github.com/eggjs/egg",target:"_blank",rel:"noopener noreferrer"}},[e._v("egg"),t("OutboundLink")],1),e._v("、支付宝钱包、云凤蝶等")]),e._v(" "),t("li",[e._v("🚄 "),t("strong",[e._v("开发启动快")]),e._v("，支持一键开启 "),t("a",{attrs:{href:"https://umijs.org/zh/plugin/umi-plugin-react.html#dll",target:"_blank",rel:"noopener noreferrer"}},[e._v("dll"),t("OutboundLink")],1),e._v(" 和 "),t("a",{attrs:{href:"https://umijs.org/zh/plugin/umi-plugin-react.html#hardSource",target:"_blank",rel:"noopener noreferrer"}},[e._v("hard-source-webpack-plugin"),t("OutboundLink")],1),e._v(" 等")]),e._v(" "),t("li",[e._v("🐠 "),t("strong",[e._v("一键兼容到 IE9")]),e._v("，基于 "),t("a",{attrs:{href:"https://umijs.org/zh/plugin/umi-plugin-react.html#polyfills",target:"_blank",rel:"noopener noreferrer"}},[e._v("umi-plugin-polyfills"),t("OutboundLink")],1)]),e._v(" "),t("li",[e._v("🍁 "),t("strong",[e._v("完善的 TypeScript 支持")]),e._v("，包括 d.ts 定义和 umi test")]),e._v(" "),t("li",[e._v("🌴 "),t("strong",[e._v("与 dva 数据流的深入融合")]),e._v("，支持 duck directory、model 的自动加载、code splitting 等等")])]),e._v(" "),t("h2",{attrs:{id:"_2-0-有什么改进"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-0-有什么改进"}},[e._v("#")]),e._v(" 2.0 有什么改进？")]),e._v(" "),t("h3",{attrs:{id:"轻内核-新手友好"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#轻内核-新手友好"}},[e._v("#")]),e._v(" 轻内核 + 新手友好")]),e._v(" "),t("p",[e._v("umi@1 内置了很多优化方案，比如按需编译、按需加载、eslint、pwa、antd 校验等等，这些方案能提升开发体验和运行效率，但同时也提升了入门 umi 的门槛。")]),e._v(" "),t("p",[e._v("所以 umi@2 默认关掉了很多优化方案：")]),e._v(" "),t("ul",[t("li",[e._v("按需编译")]),e._v(" "),t("li",[e._v("按需加载")]),e._v(" "),t("li",[e._v("serviceWorker")]),e._v(" "),t("li",[e._v("antd")]),e._v(" "),t("li",[e._v("...")])]),e._v(" "),t("p",[e._v("然后把这些功能改由插件来实现，按需开启，以保证 umi 内核的轻量。同时，默认构建只产生 index.html、umi.js 和 umi.css，对新手来说部署更友好。")]),e._v(" "),t("h3",{attrs:{id:"全新的插件机制"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#全新的插件机制"}},[e._v("#")]),e._v(" 全新的插件机制")]),e._v(" "),t("p",[e._v("umi@1 的插件机制有点过于强大，什么都能做，什么都能改。所以 umi@2 重构了插件机制，"),t("strong",[e._v("做了很多约束，明确什么能做，什么不能做")]),e._v("，并提供了一套更友好的"),t("a",{attrs:{href:"https://umijs.org/zh/plugin/develop.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("插件 API"),t("OutboundLink")],1),e._v("。")]),e._v(" "),t("p",[e._v("同时，这套插件机制已在内部得以验证，由超过 30 个插件构成的非常优秀的内部框架 Bigfish 正在服务于蚂蚁金服，包含埋点、后端接入、性能、服务接入、权限等等。")]),e._v(" "),t("h3",{attrs:{id:"umi-plugin-react"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#umi-plugin-react"}},[e._v("#")]),e._v(" umi-plugin-react")]),e._v(" "),t("p",[e._v("umi@1 的插件比较散，使用时通常需要安装多个插件，升级和使用都比较麻烦，所以我们提供了 umi-plugin-react。umi-plugin-react 是插件集，类似 babel 里 preset 的概念。")]),e._v(" "),t("p",[e._v("目前有内置了 13 个插件，包含：")]),e._v(" "),t("ul",[t("li",[e._v("dva 整合")]),e._v(" "),t("li",[e._v("antd 整合")]),e._v(" "),t("li",[e._v("routes 修改")]),e._v(" "),t("li",[e._v("一键兼容 ie9")]),e._v(" "),t("li",[e._v("约定式的 i18n 方案")]),e._v(" "),t("li",[e._v("切换 react 到 preact 或其他类 react 库")]),e._v(" "),t("li",[e._v("路由级的按需加载，可定制按需的路由等级")]),e._v(" "),t("li",[e._v("通过 dll 提速")]),e._v(" "),t("li",[e._v("通过 hardSource 提速")]),e._v(" "),t("li",[e._v("pwa")]),e._v(" "),t("li",[e._v("启用高清方案")]),e._v(" "),t("li",[e._v("启用 fastClick")]),e._v(" "),t("li",[e._v("支持配置 title")])]),e._v(" "),t("p",[e._v("详见："),t("a",{attrs:{href:"https://umijs.org/zh/plugin/umi-plugin-react.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("umijs.org/zh/plugin/u…"),t("OutboundLink")],1)]),e._v(" "),t("h3",{attrs:{id:"webpack-4-babel-7"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#webpack-4-babel-7"}},[e._v("#")]),e._v(" "),t("a",{attrs:{href:"https://medium.com/webpack/webpack-4-released-today-6cdb994702d4",target:"_blank",rel:"noopener noreferrer"}},[e._v("webpack@4"),t("OutboundLink")],1),e._v(" + "),t("a",{attrs:{href:"https://babeljs.io/blog/2018/08/27/7.0.0",target:"_blank",rel:"noopener noreferrer"}},[e._v("babel@7"),t("OutboundLink")],1),e._v(" + ...")]),e._v(" "),t("p",[e._v("趁 umi@2 的机会，我们把主要依赖度升级到了最新，除了 webpack@4 和 babel@7，还有 less@3、postcss@7、typescript@3 等，以及带来相关的构建性能提升。")]),e._v(" "),t("p",[e._v("同时，我们用了 "),t("a",{attrs:{href:"https://github.com/mozilla-neutrino/webpack-chain",target:"_blank",rel:"noopener noreferrer"}},[e._v("webpack-chain"),t("OutboundLink")],1),e._v(" 来扩展 webpack 配置，这是相比之前的 "),t("code",[e._v("webpack.config.js")]),e._v(" 更为稳妥的方案。")]),e._v(" "),t("p",[e._v("比如：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("export default {\n  chainWebpack(config, { webpack }) {\n    // 设置 alias\n    config.resolve.alias.set('a', 'path/to/a');\n\n    // 删除进度条插件\n    config.plugins.delete('progress');\n  },\n}\n\n")])])]),t("h3",{attrs:{id:"umi-generate"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#umi-generate"}},[e._v("#")]),e._v(" "),t("code",[e._v("umi generate")])]),e._v(" "),t("p",[e._v("umi@2 支持 "),t("code",[e._v("umi generate")]),e._v("（"),t("code",[e._v("umi g")]),e._v("） 命令快速生成文件，")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("$ umi g page index\n\n")])])]),t("p",[e._v("同时 "),t("code",[e._v("umi generate")]),e._v(" 是可被扩展的，比如 umi-plugin-dva 就基于此扩展了 "),t("code",[e._v("dva:model")]),e._v(" 等文件的快速生成。")]),e._v(" "),t("h3",{attrs:{id:"其他改进"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#其他改进"}},[e._v("#")]),e._v(" 其他改进")]),e._v(" "),t("ul",[t("li",[e._v("支持通过 "),t("code",[e._v(".env")]),e._v(" 和 "),t("code",[e._v(".env.local")]),e._v(" 配置环境变量")]),e._v(" "),t("li",[e._v("约定式路由支持通过 "),t("code",[e._v("yaml")]),e._v(" 格式的注释扩展路由信息")]),e._v(" "),t("li",[e._v("改进 umi dev 404 页面")]),e._v(" "),t("li",[e._v("基于 react-loadable 实现 umi/dynamic")]),e._v(" "),t("li",[e._v("umi test，允许指定测试文件，以及透传参数给 jest-cli")]),e._v(" "),t("li",[e._v("umi test 支持 webpack 别名")]),e._v(" "),t("li",[e._v("umi dev 支持配置 https 证书")]),e._v(" "),t("li",[e._v("umi dev 提取样式，然后利用 css-hot-loader 做热更新，和 umi build 保持一致")]),e._v(" "),t("li",[e._v("默认开启 "),t("a",{attrs:{href:"https://github.com/umijs/es5-imcompatible-versions",target:"_blank",rel:"noopener noreferrer"}},[e._v("es5ImcompatibleVersions"),t("OutboundLink")],1)]),e._v(" "),t("li",[e._v("删除性能消耗大户 case-sensitive-paths-webpack-plugin")]),e._v(" "),t("li",[e._v("添加 webpack alias "),t("code",[e._v("@")]),e._v("，指向 src 目录")]),e._v(" "),t("li",[e._v("优先使用本地的 umi 运行")])]),e._v(" "),t("h2",{attrs:{id:"快速上手"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#快速上手"}},[e._v("#")]),e._v(" 快速上手")]),e._v(" "),t("p",[e._v("入门 umi 很简单，")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("# 安装\n$ yarn global add umi # 或者 npm install -g umi\n\n# 新建应用\n$ mkdir myapp && cd myapp\n\n# 新建页面\n$ umi generate page index\n\n# 本地开发\n$ umi dev\n\n# 构建上线\n$ umi build\n\n")])])]),t("p",[e._v("详见："),t("a",{attrs:{href:"https://umijs.org/zh/guide/getting-started.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("umijs.org/zh/guide/ge…"),t("OutboundLink")],1),e._v("，也可以观看 "),t("a",{attrs:{href:"https://www.youtube.com/watch?v=vkAUGUlYm24",target:"_blank",rel:"noopener noreferrer"}},[e._v("10 分钟入门 umi 视频版"),t("OutboundLink")],1),e._v("。")]),e._v(" "),t("h2",{attrs:{id:"升级到-umi-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#升级到-umi-2"}},[e._v("#")]),e._v(" 升级到 umi@2")]),e._v(" "),t("p",[e._v("目前，antd 社区的 "),t("a",{attrs:{href:"https://github.com/ant-design/ant-design-pro",target:"_blank",rel:"noopener noreferrer"}},[e._v("antd-pro"),t("OutboundLink")],1),e._v(" 和 "),t("a",{attrs:{href:"https://github.com/zuiidea/antd-admin",target:"_blank",rel:"noopener noreferrer"}},[e._v("antd-admin"),t("OutboundLink")],1),e._v(" 都已升级到 umi@2，之前 umi@1 的项目可参考"),t("a",{attrs:{href:"https://umijs.org/zh/guide/migration.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("文档"),t("OutboundLink")],1),e._v("或"),t("a",{attrs:{href:"https://youtu.be/1mvKzFLLBck",target:"_blank",rel:"noopener noreferrer"}},[e._v("视频"),t("OutboundLink")],1),e._v("进行升级。")]),e._v(" "),t("p",[e._v("作者：云谦\n链接：https://juejin.cn/post/6844903668634877966\n来源：掘金\n著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。")])])}),[],!1,null,null,null);t.default=n.exports}}]);